# This file is generated by cephadm.
global:
  scrape_interval: 10s
  evaluation_interval: 10s
  external_labels:
    cluster: 6c0b4ad6-d400-11f0-a47c-bc2411928593

rule_files:
  - /etc/prometheus/alerting/*

alerting:
  alertmanagers:
    - scheme: http
      http_sd_configs:
        - url: http://192.168.200.151:8765/sd/prometheus/sd-config?service=alertmanager

scrape_configs:

  - job_name: 'fluent-bit-logs'
    scrape_interval: 5s
    static_configs:
      - targets: ['192.168.200.152:9091', '192.168.200.153:9091']

  - job_name: 'ceph'
    honor_labels: true
    relabel_configs:
    - source_labels: [__address__]
      target_label: cluster
      replacement: 6c0b4ad6-d400-11f0-a47c-bc2411928593
    - source_labels: [instance]
      target_label: instance
      replacement: 'ceph_cluster'
    http_sd_configs:
    - url: http://192.168.200.151:8765/sd/prometheus/sd-config?service=mgr-prometheus

  - job_name: 'node'
    http_sd_configs:
    - url: http://192.168.200.151:8765/sd/prometheus/sd-config?service=node-exporter
    relabel_configs:
    - source_labels: [__address__]
      target_label: cluster
      replacement: 6c0b4ad6-d400-11f0-a47c-bc2411928593


  - job_name: 'ceph-exporter'
    honor_labels: true
    relabel_configs:
    - source_labels: [__address__]
      target_label: cluster
      replacement: 6c0b4ad6-d400-11f0-a47c-bc2411928593
    http_sd_configs:
    - url: http://192.168.200.151:8765/sd/prometheus/sd-config?service=ceph-exporter

  - job_name: 'nvmeof'
    http_sd_configs:
    - url: http://192.168.200.151:8765/sd/prometheus/sd-config?service=nvmeof

  - job_name: 'federate'
    scrape_interval: 15s
    honor_labels: true
    metrics_path: '/federate'
    params:
      'match[]':
        - '{job="ceph"}'
        - '{job="node"}'
        - '{job="haproxy"}'
        - '{job="ceph-exporter"}'
    static_configs:
    - targets: []


